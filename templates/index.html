<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MTG Printable Label Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
  <link rel="icon" type="image/x-icon" href="/static/favicon.ico" />
  <link rel="apple-touch-icon" href="/static/favicon.svg" />

  <!-- Bootstrap 5.3.3 CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Bootstrap Icons (optional but recommended for icons) -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
  />

  <style>
    /* Symbol images: 20x20, with a small right margin */
    .set-item img {
      width: 20px;
      height: 20px;
      margin-right: 4px;
    }

    /* Make navbar sticky (always visible) */
    .navbar {
      z-index: 1030; /* ensure it stays above other elements */
    }

    /* Search input group - fixed width to prevent size changes */
    #navbarSupportedContent .input-group {
      width: 250px;
      position: relative;
    }

    /* Ensure search icon container has rounded left corners */
    #search-icon {
      border-top-left-radius: 0.375rem !important;
      border-bottom-left-radius: 0.375rem !important;
    }

    /* Add padding to input field to make room for clear button */
    #search {
      padding-right: 2.5rem;
      border-top-right-radius: 0.375rem !important;
      border-bottom-right-radius: 0.375rem !important;
    }

    /* Clear button styling - positioned inside the input field like Google */
    #clear-search {
      position: absolute;
      right: 0.5rem;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      padding: 0;
      border: none;
      background: transparent;
      border-radius: 50%;
      width: 1.75rem;
      height: 1.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.2s ease, visibility 0.2s ease, background-color 0.2s ease;
      z-index: 10;
      cursor: pointer;
    }

    #clear-search.visible {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }

    #clear-search:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    #clear-search:active {
      background-color: rgba(0, 0, 0, 0.1);
    }

    #clear-search i {
      font-size: 1rem;
      color: rgba(0, 0, 0, 0.54);
    }

    #clear-search:hover i {
      color: rgba(0, 0, 0, 0.87);
    }

    /* Basic accordion item spacing */
    .accordion-item {
      border: 1px solid #ddd;
      border-radius: 0.25rem;
      margin-bottom: 8px;
    }

    /* Remove blue background from accordion buttons */
    .accordion-button {
      background-color: transparent !important;
      border: none !important;
      box-shadow: none !important;
      padding: 0.5rem 1rem;
    }

    .accordion-button:not(.collapsed) {
      background-color: transparent !important;
      color: inherit;
    }

    .accordion-button:focus {
      border-color: transparent;
      box-shadow: none;
    }

    /* Adjust accordion header container */
    .accordion-header {
      border: none;
    }

    /* Truncate long set names on one line with ellipsis */
    .truncate-label {
      display: inline-block;    /* so we can constrain width */
      max-width: 280px;         /* adjust as desired */
      white-space: nowrap;      /* prevent wrapping */
      overflow: hidden;         /* clip overflow */
      text-overflow: ellipsis;  /* show "..." when truncated */
      vertical-align: middle;   /* align with the checkbox icon */
    }

    /* Group toggle button styling */
    .toggle-group {
      min-width: 140px;
    }

    /* Global toggle button styling */
    #toggle-select-all-global {
      min-width: 140px;
    }

    /* Align checkbox + label vertically and add spacing */
    .set-item {
      display: flex;
      align-items: center;
    }
    .set-item .form-check-input {
      margin-right: 8px;
    }

    /* Donate modal styling */
    #donateModal .modal-content {
      border-radius: 0.5rem;
    }

    #donateModal .modal-header {
      display: flex;
      justify-content: center;
      position: relative;
    }

    #donateModal .modal-header .modal-title {
      text-align: center;
    }

    #donateModal .modal-header .btn-close {
      position: absolute;
      right: 1rem;
    }

    #donateModal .modal-body {
      padding: 0.75rem 1.5rem;
    }

    #donateModal .modal-body a {
      color: #0d6efd;
      transition: color 0.2s ease;
    }

    #donateModal .modal-body a:hover {
      color: #0a58ca;
      text-decoration: underline;
    }

    #donateModal .lead {
      font-size: 1.1rem;
      font-weight: 400;
    }

    /* Footer styling */
    footer {
      margin-top: auto;
    }

    footer a {
      color: #0d6efd;
      transition: color 0.2s ease;
    }

    footer a:hover {
      color: #0a58ca;
      text-decoration: underline;
    }

    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
  </style>
</head>
<body>
  <!-- Sticky Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="#">
        MTG Labels
      </a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <!-- Left-aligned items: Search & Select All -->
        <div class="d-flex align-items-center ms-3">
          <!-- Search -->
          <div class="input-group me-3">
            <span class="input-group-text" id="search-icon">
              <i class="bi bi-search"></i>
            </span>
            <input
              type="text"
              class="form-control"
              placeholder="Search sets..."
              aria-label="Search sets"
              id="search"
            />
            <button
              type="button"
              id="clear-search"
              aria-label="Clear search"
            >
              <i class="bi bi-x-lg"></i>
            </button>
          </div>

          <!-- Global Select All / Deselect All -->
          <button
            type="button"
            class="btn btn-secondary me-3"
            id="toggle-select-all-global"
          >
            <i class="bi bi-check-all"></i> Select All
          </button>
        </div>

        <!-- Right-aligned items: Template dropdown & Generate PDF -->
        <div class="ms-auto d-flex align-items-center">
          <!-- Template Dropdown -->
          <div class="dropdown me-3">
            <button
              class="btn btn-secondary dropdown-toggle"
              type="button"
              id="templateDropdown"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <span id="templateDropdownText">Avery 5160/8460 (1" x 2-5/8")</span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="templateDropdown">
              <li>
                <a class="dropdown-item template-option active" href="#" data-template="avery5160">
                  1" x 2-5/8" (Avery 5160/8460, 30 Per Letter Sheet)
                </a>
              </li>
              <li>
                <a class="dropdown-item template-option" href="#" data-template="averyl7160">
                  63.5 x 38.1mm (Avery L7160, 21 Per A4 Sheet)
                </a>
              </li>
              <li>
                <a class="dropdown-item template-option" href="#" data-template="avery64x30-r">
                  64 x 30mm (Avery 64x30-R, 27 Per A4 Sheet)
                </a>
              </li>
              <li>
                <a class="dropdown-item template-option" href="#" data-template="averyj8158">
                  64 x 26.7mm (Avery J8158, 30 Per A4 Sheet)
                </a>
              </li>
              <li>
                <a class="dropdown-item template-option" href="#" data-template="averyl7157">
                  64 x 24.3mm (Avery L7157, 33 Per A4 Sheet)
                </a>
              </li>
            </ul>
          </div>

          <!-- Debug Template Checkbox (only shown if feature flag is enabled) -->
          {% if enable_template_debug %}
          <div class="form-check me-3">
            <input
              class="form-check-input"
              type="checkbox"
              name="use_template"
              id="use-template-checkbox"
              form="sets-form"
            />
            <label class="form-check-label text-light" for="use-template-checkbox">
              Overlay on Template PDF
            </label>
          </div>
          {% endif %}

          <!-- Generate PDF button (submits #sets-form) -->
          <button
            type="submit"
            class="btn btn-primary"
            form="sets-form"
          >
            <i class="bi bi-file-earmark-pdf"></i> Generate PDF
          </button>
          <!-- Hidden input to store selected template (default will be set by JavaScript) -->
          <input type="hidden" name="template" id="selectedTemplate" value="" form="sets-form" />
        </div>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <!-- <h1 class="mb-4 text-center">MTG Printable Label Generator</h1> -->

    <!-- Accordion for grouped sets -->
    <form action="/generate-pdf" method="post" id="sets-form">
      {% for group, sets in grouped_sets.items() %}
      <div class="accordion" id="accordion-{{ group }}">
        <div class="accordion-item">
          <!--
            A parent container for the entire heading row (full width).
            We include the heading + "Select Group" button in one line.
          -->
          <div
            class="d-flex justify-content-between align-items-center w-100 px-2 py-2"
            id="heading-{{ group }}"
          >
            <!-- The heading itself -->
            <h2 class="accordion-header mb-0 flex-grow-1">
              <!-- The standard Bootstrap accordion button -->
              <button
                class="accordion-button collapsed text-start w-100"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#collapse-{{ group }}"
                aria-expanded="false"
                aria-controls="collapse-{{ group }}"
              >
                {{ group }}
              </button>
            </h2>

            <!-- Per-group toggle button (Select Group / Deselect Group) -->
            <button
              type="button"
              class="btn btn-sm btn-secondary toggle-group"
              data-group="#collapse-{{ group }}"
            >
              <i class="bi bi-check-all"></i> Select Group
            </button>
          </div>

          <!-- Collapsible content -->
          <div
            id="collapse-{{ group }}"
            class="accordion-collapse collapse"
            aria-labelledby="heading-{{ group }}"
            data-bs-parent="#accordion-{{ group }}"
          >
            <div class="accordion-body">
              <!-- Slightly tighter spacing between columns (g-1) -->
              <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-1">
                {% for set in sets %}
                <div class="col">
                  <div class="form-check set-item">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      name="set_ids"
                      value="{{ set.id }}"
                      id="set-{{ set.id }}"
                    />
                    <!--
                      Symbol on the LEFT, then the set name,
                      with full name in the "title" attribute for hover.
                    -->
                    <label
                      class="form-check-label truncate-label"
                      for="set-{{ set.id }}"
                      title="{{ set.name }}"
                    >
                      <img src="{{ set.icon_svg_uri }}" alt="symbol" />
                      {{ set.name }}
                    </label>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </form>
  </div>

  <!-- Footer -->
  <footer class="mt-5 py-4 bg-light border-top">
    <div class="container">
      <div class="row">
        <div class="col text-center">
          <p class="mb-2 small text-muted" style="line-height: 1.6;">
            This label generator is unofficial Fan Content permitted under the<br>
            <a href="https://company.wizards.com/fancontentpolicy" target="_blank" rel="noopener noreferrer" class="text-decoration-none">Wizards of the Coast Fan Content Policy</a>.
          </p>

          <p class="mb-0 small text-muted" style="line-height: 1.6;">
            It uses set information provided by <a href="https://scryfall.com/" target="_blank" rel="noopener noreferrer" class="text-decoration-none">Scryfall</a> in accordance with their <a href="https://scryfall.com/docs/api#use-of-scryfall-data" target="_blank" rel="noopener noreferrer" class="text-decoration-none">guidelines</a>.
          </p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Donate Modal -->
  <div class="modal fade" id="donateModal" tabindex="-1" aria-labelledby="donateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" style="max-width: 500px;">
      <div class="modal-content">
        <div class="modal-header border-bottom-0 pb-1 pt-3">
          <h5 class="modal-title fw-bold" id="donateModalLabel">Thank You!</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body pt-0 pb-2">
          <p class="text-center mb-3 lead">Your PDF is being generated. If you find this tool useful, consider supporting its development!</p>
          <div class="text-center mb-2">
            <form action="https://www.paypal.com/donate" method="post" target="_top" class="d-inline-block">
              <input type="hidden" name="business" value="3ABRQKUCLUGXN" />
              <input type="hidden" name="no_recurring" value="0" />
              <input type="hidden" name="item_name" value="for buying more MTG cards :)" />
              <input type="hidden" name="currency_code" value="USD" />
              <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" title="PayPal - The safer, easier way to pay online!" alt="Donate with PayPal button" />
              <img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" />
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const searchInput = document.getElementById("search");
      const clearButton = document.getElementById("clear-search");
      const globalToggleBtn = document.getElementById("toggle-select-all-global");

      // ========== GLOBAL SELECT ALL/DESELECT ALL ==========
      function updateGlobalToggleLabel() {
        const allCbs = document.querySelectorAll('input[type="checkbox"]');
        const anyUnchecked = Array.from(allCbs).some(cb => !cb.checked);
        globalToggleBtn.innerHTML = anyUnchecked
          ? '<i class="bi bi-check-all"></i> Select All'
          : '<i class="bi bi-x-circle"></i> Deselect All';
      }

      globalToggleBtn.addEventListener("click", function () {
        const allCbs = document.querySelectorAll('input[type="checkbox"]');
        const anyUnchecked = Array.from(allCbs).some(cb => !cb.checked);
        allCbs.forEach(cb => (cb.checked = anyUnchecked));
        saveGlobalSelections();
        updateGlobalToggleLabel();
        // Also update each group's button text
        document.querySelectorAll(".toggle-group").forEach(btn => {
          const groupSelector = btn.getAttribute("data-group");
          updateGroupToggleLabel(groupSelector, btn);
        });
        // Expand all groups when selecting all
        if (anyUnchecked) {
          document.querySelectorAll(".accordion-collapse").forEach(function (collapseElement) {
            let collapseInstance = bootstrap.Collapse.getInstance(collapseElement);
            if (!collapseInstance) {
              collapseInstance = new bootstrap.Collapse(collapseElement, { toggle: false });
            }
            collapseInstance.show();
          });
        }
      });

      // ========== GROUP TOGGLE (SELECT GROUP / DESELECT GROUP) ==========
      document.querySelectorAll(".toggle-group").forEach(function (btn) {
        btn.addEventListener("click", function () {
          const groupSelector = this.getAttribute("data-group");
          const checkboxes = document.querySelectorAll(groupSelector + " input[type='checkbox']");
          const allChecked = Array.from(checkboxes).every(cb => cb.checked);
          checkboxes.forEach(cb => (cb.checked = !allChecked));
          saveGlobalSelections();
          updateGlobalToggleLabel();
          updateGroupToggleLabel(groupSelector, this);
          // Expand the group when selecting items
          if (!allChecked) {
            const collapseElement = document.querySelector(groupSelector);
            if (collapseElement) {
              let collapseInstance = bootstrap.Collapse.getInstance(collapseElement);
              if (!collapseInstance) {
                collapseInstance = new bootstrap.Collapse(collapseElement, { toggle: false });
              }
              collapseInstance.show();
            }
          }
        });
      });

      function updateGroupToggleLabel(groupSelector, button) {
        const checkboxes = document.querySelectorAll(groupSelector + " input[type='checkbox']");
        const allChecked = Array.from(checkboxes).every(cb => cb.checked);
        button.innerHTML = allChecked
          ? '<i class="bi bi-x-circle"></i> Deselect Group'
          : '<i class="bi bi-check-all"></i> Select Group';
      }

      // ========== LOCAL STORAGE PERSISTENCE ==========
      function saveGlobalSelections() {
        const selected = Array.from(document.querySelectorAll('input[type="checkbox"]:checked'))
          .map(cb => cb.value);
        localStorage.setItem("selectedSets", JSON.stringify(selected));
      }

      function loadGlobalSelections() {
        const stored = localStorage.getItem("selectedSets");
        if (stored) {
          const selected = JSON.parse(stored);
          document.querySelectorAll('input[type="checkbox"]').forEach(function (cb) {
            cb.checked = selected.includes(cb.value);
          });
        }
      }

      // ========== EXPAND GROUPS WITH SELECTED SETS ON LOAD ==========
      function expandGroupsWithSelectedSets() {
        const selected = JSON.parse(localStorage.getItem("selectedSets") || "[]");
        document.querySelectorAll(".accordion").forEach(function (accordion) {
          const collapseElement = accordion.querySelector(".accordion-collapse");
          let groupHasSelected = false;
          accordion.querySelectorAll("input[type='checkbox']").forEach(cb => {
            if (selected.includes(cb.value)) groupHasSelected = true;
          });
          if (groupHasSelected) {
            let collapseInstance = bootstrap.Collapse.getInstance(collapseElement);
            if (!collapseInstance) {
              collapseInstance = new bootstrap.Collapse(collapseElement, { toggle: false });
            }
            collapseInstance.show();
          }
          // Update the group toggle button text
          const toggleBtn = accordion.querySelector(".toggle-group");
          if (toggleBtn && collapseElement) {
            updateGroupToggleLabel("#" + collapseElement.id, toggleBtn);
          }
        });
      }

      // ========== CHECKBOX CHANGE HANDLER ==========
      document.querySelectorAll("input[type='checkbox']").forEach(function (cb) {
        cb.addEventListener("change", function () {
          saveGlobalSelections();
          updateGlobalToggleLabel();
          const parentAccordion = cb.closest(".accordion");
          if (parentAccordion) {
            const collapseElement = parentAccordion.querySelector(".accordion-collapse");
            const toggleBtn = parentAccordion.querySelector(".toggle-group");
            if (collapseElement && toggleBtn) {
              updateGroupToggleLabel("#" + collapseElement.id, toggleBtn);
            }
          }
        });
      });

      // ========== SEARCH FUNCTIONALITY ==========
      function toggleClearButton() {
        if (searchInput.value.trim()) {
          clearButton.classList.add("visible");
        } else {
          clearButton.classList.remove("visible");
        }
      }

      function handleSearch() {
        const filter = searchInput.value.toLowerCase();
        document.querySelectorAll(".accordion").forEach(function (accordion) {
          let groupHasMatch = false;
          accordion.querySelectorAll(".col").forEach(function (col) {
            const item = col.querySelector(".set-item");
            if (!item) return;
            const text = item.textContent.toLowerCase();
            if (text.indexOf(filter) > -1) {
              col.style.display = "";
              groupHasMatch = true;
            } else {
              col.style.display = "none";
            }
          });
          const collapseElement = accordion.querySelector(".accordion-collapse");
          if (groupHasMatch) {
            let collapseInstance = bootstrap.Collapse.getInstance(collapseElement);
            if (!collapseInstance) {
              collapseInstance = new bootstrap.Collapse(collapseElement, { toggle: false });
            }
            collapseInstance.show();
            accordion.style.display = "";
          } else {
            let collapseInstance = bootstrap.Collapse.getInstance(collapseElement);
            if (collapseInstance) collapseInstance.hide();
            accordion.style.display = "none";
          }
        });
      }

      function resetAccordionsToDefault() {
        document.querySelectorAll(".col").forEach(col => (col.style.display = ""));
        document.querySelectorAll(".accordion").forEach(function (accordion) {
          const collapseElem = accordion.querySelector(".accordion-collapse");
          let groupHasSelected = false;
          accordion.querySelectorAll("input[type='checkbox']").forEach(cb => {
            if (cb.checked) groupHasSelected = true;
          });
          let ci = bootstrap.Collapse.getInstance(collapseElem);
          if (!ci) {
            ci = new bootstrap.Collapse(collapseElem, { toggle: false });
          }
          groupHasSelected ? ci.show() : ci.hide();
          accordion.style.display = "";
        });
      }

      // ========== FORM SUBMISSION VALIDATION & DONATE MODAL ==========
      const setsForm = document.getElementById("sets-form");
      const donateModal = new bootstrap.Modal(document.getElementById("donateModal"));

      setsForm.addEventListener("submit", async function (e) {
        const checkedBoxes = document.querySelectorAll('input[name="set_ids"]:checked');
        if (checkedBoxes.length === 0) {
          e.preventDefault();
          alert("Please select at least one set before generating the PDF.");
          return false;
        }

        // Prevent default form submission
        e.preventDefault();

        // Show the donate modal
        donateModal.show();

        // Prepare form data
        const formData = new FormData(setsForm);

        try {
          // Submit form via fetch API
          const response = await fetch("/generate-pdf", {
            method: "POST",
            body: formData
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          // Get the PDF blob
          const blob = await response.blob();

          // Create download link
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "mtg_labels.pdf";
          document.body.appendChild(a);
          a.click();

          // Cleanup
          window.URL.revokeObjectURL(url);
          document.body.removeChild(a);
        } catch (error) {
          console.error("Error generating PDF:", error);
          donateModal.hide();
          alert("An error occurred while generating the PDF. Please try again.");
        }
      });

      // ========== TEMPLATE SELECTION ==========
      const templateDropdown = document.getElementById("templateDropdown");
      const templateDropdownText = document.getElementById("templateDropdownText");
      const selectedTemplateInput = document.getElementById("selectedTemplate");
      const templateOptions = document.querySelectorAll(".template-option");

      // Get default template from the first active option (or first option if none active)
      function getDefaultTemplate() {
        const activeOption = Array.from(templateOptions).find(opt => opt.classList.contains("active"));
        return activeOption
          ? activeOption.getAttribute("data-template")
          : templateOptions[0]?.getAttribute("data-template") || "avery5160";
      }

      // Helper function to get template label text from dropdown items
      function getTemplateLabel(templateId) {
        const option = Array.from(templateOptions).find(
          opt => opt.getAttribute("data-template") === templateId
        );
        return option ? option.textContent.trim() : "Select Template";
      }

      // Load saved template from localStorage
      function loadTemplateSelection() {
        const defaultTemplate = getDefaultTemplate();
        const savedTemplate = localStorage.getItem("selectedTemplate") || defaultTemplate;
        selectedTemplateInput.value = savedTemplate;
        templateDropdownText.textContent = getTemplateLabel(savedTemplate);

        // Update active state
        templateOptions.forEach(option => {
          if (option.getAttribute("data-template") === savedTemplate) {
            option.classList.add("active");
          } else {
            option.classList.remove("active");
          }
        });
      }

      // Handle template option clicks
      templateOptions.forEach(option => {
        option.addEventListener("click", function(e) {
          e.preventDefault();
          const template = this.getAttribute("data-template");
          selectedTemplateInput.value = template;
          templateDropdownText.textContent = this.textContent.trim();
          localStorage.setItem("selectedTemplate", template);

          // Update active state
          templateOptions.forEach(opt => opt.classList.remove("active"));
          this.classList.add("active");
        });
      });

      // ========== ON PAGE LOAD ==========
      loadTemplateSelection();
      loadGlobalSelections();
      updateGlobalToggleLabel();
      expandGroupsWithSelectedSets();

      // Hook up search + clear button
      toggleClearButton();
      searchInput.addEventListener("input", function () {
        toggleClearButton();
        if (searchInput.value.trim() === "") {
          resetAccordionsToDefault();
        } else {
          handleSearch();
        }
      });
      clearButton.addEventListener("click", function () {
        searchInput.value = "";
        toggleClearButton();
        resetAccordionsToDefault();
      });
    });
  </script>
</body>
</html>
